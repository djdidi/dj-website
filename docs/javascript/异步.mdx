---
sidebar_position: 13
---

## å¼‚æ­¥æ“ä½œæ¦‚è¿°

### ä¸€äº›åŸºæœ¬æ¦‚å¿µ

**è¿›ç¨‹å’Œçº¿ç¨‹**

- è¿›ç¨‹(process)ï¼šæ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„å•å…ƒï¼Œä¸€ä¸ªè¿›ç¨‹åŒ…æ‹¬äº†è¿è¡Œä¸­çš„ç¨‹åºå’Œç¨‹åºæ‰€ä½¿ç”¨åˆ°çš„å†…å­˜å’Œç³»ç»Ÿèµ„æºã€‚
- çº¿ç¨‹(thread)ï¼šçº¿ç¨‹æ˜¯è¿›ç¨‹ä¸‹çš„æ‰§è¡Œè€…ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘ä¼šå¼€å¯ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ã€‚

**åŒæ­¥å’Œå¼‚æ­¥**

- åŒæ­¥(Synchronous)ï¼šå‘å‡ºè°ƒç”¨åï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœå‰ï¼Œè¯¥è°ƒç”¨ä¸è¿”å›ã€‚
- å¼‚æ­¥(asynchronous)ï¼šå‘å‡ºè°ƒç”¨åï¼Œè°ƒç”¨ç«‹å³è¿”å›ï¼Œæ²¡æœ‰è¿”å›ç»“æœã€‚ç»“æœç”±å›è°ƒå‡½æ•°ç»™å‡ºã€‚

**é˜»å¡å’Œéé˜»å¡**

- é˜»å¡è°ƒç”¨ï¼šè°ƒç”¨ç»“æœè¿”å›ä¹‹å‰ï¼Œå½“å‰çº¿ç¨‹è¢«æŒ‚èµ·ã€‚è°ƒç”¨çº¿ç¨‹åªæœ‰åœ¨å¾—åˆ°ç»“æœåæ‰ä¼šè¿”å›ã€‚
- éé˜»å¡è°ƒç”¨ï¼šåœ¨ä¸èƒ½ç«‹åˆ»å¾—åˆ°ç»“æœä¹‹å‰ï¼Œè¯¥è°ƒç”¨ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚

**ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Ÿ**

- è®¾è®¡å¦‚æ­¤ï¼Œä¸»è¦ç”¨äºäº¤äº’é€»è¾‘ï¼Œå•çº¿ç¨‹ç®€å•ç¬¦åˆè®¾è®¡ã€‚å¤šçº¿ç¨‹æ“ä½œ UI è¿˜éœ€è¦è€ƒè™‘é”ğŸ”’ç­‰é—®é¢˜ã€‚

**æµè§ˆå™¨çš„æ˜¯å¤šçº¿ç¨‹**

ä¸åŒç¯å¢ƒå®ç°ä¸åŒï¼Œä¾‹å¦‚ chrome é»˜è®¤ä¸€ä¸ªtabé¡µä¸€ä¸ªè¿›ç¨‹ï¼Œé‡Œé¢æœ‰å¤šä¸ªçº¿ç¨‹ï¼š

- **GUI æ¸²æŸ“çº¿ç¨‹**ï¼šå½“ç•Œé¢éœ€è¦é‡ç»˜ï¼ˆRepaintï¼‰æˆ–ç”±äºæŸç§æ“ä½œå¼•å‘å›æµï¼ˆreflowï¼‰æ—¶ï¼Œè¯¥çº¿ç¨‹å°±ä¼šæ‰§è¡Œã€‚
- **JS å¼•æ“çº¿ç¨‹**ï¼ˆä¸ GUI æ¸²æŸ“çº¿ç¨‹äº’æ–¥ï¼‰ï¼šJS å¼•æ“æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œä¸€ç›´ç­‰å¾…ç€ä»»åŠ¡é˜Ÿåˆ—ä¸­ä»»åŠ¡çš„åˆ°æ¥ï¼Œç„¶ååŠ ä»¥å¤„ç†ã€‚
- **äº‹ä»¶è§¦å‘çº¿ç¨‹**ï¼šå½“ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘æ—¶è¯¥çº¿ç¨‹ä¼šæŠŠäº‹ä»¶æ·»åŠ åˆ°â€œä»»åŠ¡é˜Ÿåˆ—â€çš„é˜Ÿå°¾ï¼Œç­‰å¾… JavaScript å¼•æ“çš„å¤„ç†ã€‚
- å®šæ—¶è§¦å‘å™¨çº¿ç¨‹
- å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹
- ......

**å•çº¿ç¨‹æ€ä¹ˆå¤„ç†å¤šä»»åŠ¡ï¼Ÿ**

å¿…é¡»å‘¨æœŸæ€§æ£€æŸ¥å„ä¸ªä»»åŠ¡çš„ä¿¡å·ï¼Œæ¥è°ƒåº¦æ‰§è¡Œã€‚

**å¼•å‡º JavaScript ä¸­çš„äº‹ä»¶å¾ªç¯ `Event Loop` æ¨¡å‹ã€‚**

### äº‹ä»¶å¾ªç¯å’Œä»»åŠ¡é˜Ÿåˆ—

> Event Loop è§„èŒƒå®šä¹‰ https://html.spec.whatwg.org/multipage/webappapis.html#event-loop-processing-model
>
> MDN-äº‹ä»¶å¾ªç¯ä¸å¹¶å‘æ¨¡å‹ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Event_loop

**äº‹ä»¶å¾ªç¯æ˜¯ä»€ä¹ˆï¼Ÿ**

- JavaScript æœ‰ä¸€ä¸ªåŸºäºäº‹ä»¶å¾ªç¯çš„å¹¶å‘æ¨¡å‹ï¼Œäº‹ä»¶å¾ªç¯è´Ÿè´£æ‰§è¡Œä»£ç ã€æ”¶é›†å’Œå¤„ç†äº‹ä»¶ä»¥åŠæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å­ä»»åŠ¡ã€‚
- äº‹ä»¶å¾ªç¯é©±åŠ¨ç€æµè§ˆå™¨ä¸­å‘ç”Ÿçš„ä¸€åˆ‡ï¼Œ**å®ƒè´Ÿè´£è°ƒåº¦å’Œæ‰§è¡Œåœ¨å…¶çº¿ç¨‹ä¸­è¿è¡Œçš„æ¯ä¸€æ®µä»£ç **ã€‚

**ä»»åŠ¡å’Œå¾®ä»»åŠ¡**

å°†æ‰§è¡Œä»»åŠ¡åˆ†ä¸ºä¸¤ç§ï¼Œä¸åŒçš„å¼‚æ­¥ä»»åŠ¡åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚

- å®ä»»åŠ¡ï¼šæ•´ä½“ä»£ç scriptã€setTimeoutã€setIntervalã€UI render...
- å¾®ä»»åŠ¡ï¼špromiseã€MutationObserverã€queueMicrotaskï¼›(nodejs)setImmediateã€process.nextTick...

**ä»»åŠ¡é˜Ÿåˆ—çš„æ‰§è¡Œé¡ºåº**

1. ä¸»åŒæ­¥ä»»åŠ¡
2. å…¨éƒ¨å¾®ä»»åŠ¡ï¼ˆæœ‰æ–°äº§ç”Ÿçš„å¾®ä»»åŠ¡ä¹Ÿæ‰§è¡Œå®Œï¼‰
3. ä¸€ä¸ªå®ä»»åŠ¡
4. æ¸²æŸ“å˜æ›´
5. æ²¡æœ‰ä»»åŠ¡åˆ™ä¼‘çœ 
6. ç›´åˆ°å‡ºç°æ–°çš„ä»»åŠ¡ï¼Œè½¬æ­¥éª¤ 1...... å¦‚æ­¤å¾ªç¯

### å¼‚æ­¥ç¼–ç¨‹çš„å½¢å¼

- å›è°ƒå‡½æ•°ï¼šè§£å†³äº†åŒæ­¥é—®é¢˜ï¼Œä½†æœ‰å›è°ƒåœ°ç‹±
- Promiseï¼šè§£å†³éƒ¨åˆ†å›è°ƒåœ°ç‹±å¯è¯»æ€§
- generatorï¼šå¯ä»¥æ§åˆ¶å‡½æ•°æ‰§è¡Œï¼Œä½†è¯­ä¹‰ä¸ä¾¿
- async/awaitï¼šè¯­æ³•ç³–ï¼ŒåŒæ­¥è¯­ä¹‰ç¼–å†™å¼‚æ­¥ä»£ç 

- äº‹ä»¶ç›‘å¬ï¼šEventEmitter
- å‘å¸ƒ/è®¢é˜…ï¼šsubscribe / publish

## JavaScript ä¸­çš„å¼‚æ­¥

### Callback

```javascript
step1(function (value1) {
  step2(value1, function(value2) {
    step3(value2, function(value3) {
      step4(value3, function(value4) {
        // Do something with value4
      });
    });
  });
});
```

### Generator

Generator å¯¹è±¡ç”±ç”Ÿæˆå™¨å‡½æ•°è¿”å›å¹¶ä¸”å®ƒç¬¦åˆå¯è¿­ä»£åè®®å’Œè¿­ä»£å™¨åè®®ã€‚

> å…·ä½“çœ‹ *è¿­ä»£åè®®* éƒ¨åˆ†

```javascript
function* infinite() {
  let index = 0;

  while (true) {
    yield index++;
  }
}

const generator = infinite(); // "Generator { }"

console.log(generator.next().value); // 0
console.log(generator.next().value); // 1
console.log(generator.next().value); // 2
// â€¦

```

### Promise

Promise å¯¹è±¡è¡¨ç¤ºå¼‚æ­¥æ“ä½œæœ€ç»ˆçš„å®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰ä»¥åŠå…¶ç»“æœå€¼ã€‚

ç”¨æ³•çœ‹æ–‡æ¡£ã€‚

> promise/A+ https://promisesaplus.com/
>
> ECMAScript è§„èŒƒ https://tc39.es/ecma262/multipage/control-abstraction-objects.html#sec-promise-objects

> **æ‰‹å†™å®ç° `Promise`**

### async/await

`async/await` å…³é”®å­—è®©æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼å†™å‡ºåŸºäº `Promise` çš„å¼‚æ­¥è¡Œä¸ºï¼Œè€Œæ— éœ€åˆ»æ„åœ°é“¾å¼è°ƒç”¨ promiseã€‚

```javascript
async function getDataSteps(params) {
  try {
    const ret1 = await step1(params);
    const ret2 = await step2(ret1);
    return step3(ret2);
  } catch (e) {
    console.log('step err', e);
  }
}
```

> **æ‰‹å†™å®ç° `async/await`**
